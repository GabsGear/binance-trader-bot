/* 
jquery.event.drag.js ~ v1.5 ~ Copyright (c) 2008, Three Dub Media (http://threedubmedia.com)  
Liscensed under the MIT License ~ http://threedubmedia.googlecode.com/files/MIT-LICENSE.txt
*/
(function(e){e.fn.drag=function(l,k,j){if(k){this.bind("dragstart",l)}if(j){this.bind("dragend",j)}return !l?this.trigger("drag"):this.bind("drag",k?k:l)};var a=e.event,b=a.special,f=b.drag={not:":input",distance:0,which:1,dragging:false,setup:function(j){j=e.extend({distance:f.distance,which:f.which,not:f.not},j||{});j.distance=i(j.distance);a.add(this,"mousedown",h,j);if(this.attachEvent){this.attachEvent("ondragstart",d)}},teardown:function(){a.remove(this,"mousedown",h);if(this===f.dragging){f.dragging=f.proxy=false}g(this,true);if(this.detachEvent){this.detachEvent("ondragstart",d)}}};b.dragstart=b.dragend={setup:function(){},teardown:function(){}};function h(l){var k=this,j,m=l.data||{};if(m.elem){k=l.dragTarget=m.elem;l.dragProxy=f.proxy||k;l.cursorOffsetX=m.pageX-m.left;l.cursorOffsetY=m.pageY-m.top;l.offsetX=l.pageX-l.cursorOffsetX;l.offsetY=l.pageY-l.cursorOffsetY}else{if(f.dragging||(m.which>0&&l.which!=m.which)||e(l.target).is(m.not)){return}}switch(l.type){case"mousedown":e.extend(m,e(k).offset(),{elem:k,target:l.target,pageX:l.pageX,pageY:l.pageY});a.add(document,"mousemove mouseup",h,m);g(k,false);f.dragging=null;return false;case !f.dragging&&"mousemove":if(i(l.pageX-m.pageX)+i(l.pageY-m.pageY)<m.distance){break}l.target=m.target;j=c(l,"dragstart",k);if(j!==false){f.dragging=k;f.proxy=l.dragProxy=e(j||k)[0]}case"mousemove":if(f.dragging){j=c(l,"drag",k);if(b.drop){b.drop.allowed=(j!==false);b.drop.handler(l)}if(j!==false){break}l.type="mouseup"}case"mouseup":a.remove(document,"mousemove mouseup",h);if(f.dragging){if(b.drop){b.drop.handler(l)}c(l,"dragend",k)}g(k,true);f.dragging=f.proxy=m.elem=false;break}return true}function c(m,k,l){m.type=k;var j=e.event.handle.call(l,m);return j===false?false:j||m.result}function i(j){return Math.pow(j,2)}function d(){return(f.dragging===false)}function g(k,j){if(!k){return}k.unselectable=j?"off":"on";k.onselectstart=function(){return j};if(k.style){k.style.MozUserSelect=j?"":"none"}}})(jQuery);